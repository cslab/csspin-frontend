# The spinfile.yaml is only used to build the documentation for readthedocs.

spin:
    project_name: csspin-frontend

plugin_packages:
    - csspin-docs
    - csspin-python[aws_auth]
    - -e .

plugins:
    - csspin_docs.sphinx
    - csspin_frontend:
          - cypress
          - jest
          - jsconfig
          - node
    - csspin_java.java

java:
    version: '21'

python:
    version: '3.11.9'
    requirements:
        - sphinx-rtd-theme
    aws_auth:
        # required to access Codeartifact for cs.platform, cs.web, ce_services
        enabled: True
        static_oidc: True
        key_duration: 600 # 10 minutes

node:
    version: '20'

jest:
    source: .

sphinx:
    docs: doc

build_rules:
    task docs:
        sources: doc/_schemaref.rst
    doc/_schemaref.rst:
        sources: [src/csspin_frontend]
        spin:
            - schemadoc cypress --rst -o doc/plugins/cypress_schemaref.rst
            - schemadoc jest --rst -o doc/plugins/jest_schemaref.rst
            - schemadoc jsconfig --rst -o doc/plugins/jsconfig_schemaref.rst
            - schemadoc node --rst -o doc/plugins/node_schemaref.rst
